{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}import*as React from'react';import Animated from\"react-native-web/dist/exports/Animated\";import BackHandler from\"react-native-web/dist/exports/BackHandler\";import Easing from\"react-native-web/dist/exports/Easing\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import TouchableWithoutFeedback from\"react-native-web/dist/exports/TouchableWithoutFeedback\";import View from\"react-native-web/dist/exports/View\";import{useSafeAreaInsets}from'react-native-safe-area-context';import useEventCallback from'use-event-callback';import{useInternalTheme}from\"../core/theming\";import{addEventListener}from\"../utils/addEventListener\";import useAnimatedValue from\"../utils/useAnimatedValue\";import Surface from\"./Surface\";var DEFAULT_DURATION=220;function Modal(_ref){var _theme$colors;var _ref$dismissable=_ref.dismissable,dismissable=_ref$dismissable===void 0?true:_ref$dismissable,_ref$visible=_ref.visible,visible=_ref$visible===void 0?false:_ref$visible,_ref$overlayAccessibi=_ref.overlayAccessibilityLabel,overlayAccessibilityLabel=_ref$overlayAccessibi===void 0?'Close modal':_ref$overlayAccessibi,_ref$onDismiss=_ref.onDismiss,onDismiss=_ref$onDismiss===void 0?function(){}:_ref$onDismiss,children=_ref.children,contentContainerStyle=_ref.contentContainerStyle,style=_ref.style,themeOverrides=_ref.theme,_ref$testID=_ref.testID,testID=_ref$testID===void 0?'modal':_ref$testID;var theme=useInternalTheme(themeOverrides);var visibleRef=React.useRef(visible);React.useEffect(function(){visibleRef.current=visible;});var onDismissCallback=useEventCallback(onDismiss);var scale=theme.animation.scale;var _useSafeAreaInsets=useSafeAreaInsets(),top=_useSafeAreaInsets.top,bottom=_useSafeAreaInsets.bottom;var opacity=useAnimatedValue(visible?1:0);var _React$useState=React.useState(visible),_React$useState2=_slicedToArray(_React$useState,2),rendered=_React$useState2[0],setRendered=_React$useState2[1];if(visible&&!rendered){setRendered(true);}var showModal=React.useCallback(function(){Animated.timing(opacity,{toValue:1,duration:scale*DEFAULT_DURATION,easing:Easing.out(Easing.cubic),useNativeDriver:true}).start();},[opacity,scale]);var hideModal=React.useCallback(function(){Animated.timing(opacity,{toValue:0,duration:scale*DEFAULT_DURATION,easing:Easing.out(Easing.cubic),useNativeDriver:true}).start(function(_ref2){var finished=_ref2.finished;if(!finished){return;}if(visible){onDismissCallback();}if(visibleRef.current){showModal();}else{setRendered(false);}});},[onDismissCallback,opacity,scale,showModal,visible]);React.useEffect(function(){if(!visible){return undefined;}var onHardwareBackPress=function onHardwareBackPress(){if(dismissable){hideModal();}return true;};var subscription=addEventListener(BackHandler,'hardwareBackPress',onHardwareBackPress);return function(){return subscription.remove();};},[dismissable,hideModal,visible]);var prevVisible=React.useRef(null);React.useEffect(function(){if(prevVisible.current!==visible){if(visible){showModal();}else{hideModal();}}prevVisible.current=visible;});if(!rendered)return null;return React.createElement(Animated.View,{pointerEvents:visible?'auto':'none',accessibilityViewIsModal:true,accessibilityLiveRegion:\"polite\",style:StyleSheet.absoluteFill,onAccessibilityEscape:hideModal,testID:testID},React.createElement(TouchableWithoutFeedback,{accessibilityLabel:overlayAccessibilityLabel,accessibilityRole:\"button\",disabled:!dismissable,onPress:dismissable?hideModal:undefined,importantForAccessibility:\"no\"},React.createElement(Animated.View,{testID:testID+\"-backdrop\",style:[styles.backdrop,{backgroundColor:(_theme$colors=theme.colors)===null||_theme$colors===void 0?void 0:_theme$colors.backdrop,opacity:opacity}]})),React.createElement(View,{style:[styles.wrapper,{marginTop:top,marginBottom:bottom},style],pointerEvents:\"box-none\",testID:testID+\"-wrapper\"},React.createElement(Surface,{testID:testID+\"-surface\",theme:theme,style:[{opacity:opacity},styles.content,contentContainerStyle]},children)));}export default Modal;var styles=StyleSheet.create({backdrop:{flex:1},wrapper:_objectSpread(_objectSpread({},StyleSheet.absoluteFillObject),{},{justifyContent:'center'}),content:{backgroundColor:'transparent',justifyContent:'center'}});","map":{"version":3,"sources":["Modal.tsx"],"names":["React","useSafeAreaInsets","useEventCallback","useInternalTheme","addEventListener","useAnimatedValue","Surface","DEFAULT_DURATION","Modal","dismissable","visible","overlayAccessibilityLabel","onDismiss","children","contentContainerStyle","style","theme","themeOverrides","testID","visibleRef","useRef","useEffect","current","onDismissCallback","scale","animation","top","bottom","opacity","rendered","setRendered","useState","showModal","useCallback","Animated","timing","toValue","duration","easing","Easing","out","cubic","useNativeDriver","start","hideModal","finished","undefined","onHardwareBackPress","subscription","BackHandler","remove","prevVisible","StyleSheet","absoluteFill","styles","backdrop","backgroundColor","colors","wrapper","marginTop","marginBottom","content","create","flex","absoluteFillObject","justifyContent"],"mappings":"y4BAAA,MAAO,GAAKA,MAAK,KAAM,OAAO,CAAA,4YAY9B,OAASC,iBAAiB,KAAQ,gCAAgC,CAClE,MAAOC,iBAAgB,KAAM,oBAAoB,CAEjD,OAASC,gBAAgB,uBAEzB,OAASC,gBAAgB,iCACzB,MAAOC,iBAAgB,iCACvB,MAAOC,QAAO,iBA0Cd,GAAMC,iBAAgB,CAAG,GAAG,CAyC5B,QAASC,MAAK,CAAA,IAAA,CAUJ,CAAA,GAAA,cAAA,CAVK,qBAUP,IAAA,CATNC,WAAW,CAAXA,WAAW,2BAAG,IAAI,+BASZ,IAAA,CARNC,OAAO,CAAPA,OAAO,uBAAG,KAAK,oCAQT,IAAA,CAPNC,yBAAyB,CAAzBA,yBAAyB,gCAAG,aAAa,sCAOnC,IAAA,CANNC,SAAS,CAATA,SAAS,yBAAG,UAAM,CAAC,CAAC,gBACpBC,QAAQ,CAKF,IAAA,CALNA,QAAQ,CACRC,qBAAqB,CAIf,IAAA,CAJNA,qBAAqB,CACrBC,KAAK,CAGC,IAAA,CAHNA,KAAK,CACEE,cAAc,CAEf,IAAA,CAFND,KAAK,aAEC,IAAA,CADNE,MAAM,CAANA,MAAM,sBAAG,OAAA,aAET,GAAMF,MAAK,CAAGb,gBAAgB,CAACc,cAAc,CAAC,CAC9C,GAAME,WAAU,CAAGnB,KAAK,CAACoB,MAAM,CAACV,OAAO,CAAC,CAExCV,KAAK,CAACqB,SAAS,CAAC,UAAM,CACpBF,UAAU,CAACG,OAAO,CAAGZ,OAAO,CAC9B,CAAC,CAAC,CAEF,GAAMa,kBAAiB,CAAGrB,gBAAgB,CAACU,SAAS,CAAC,CAErD,GAAQY,MAAAA,CAAUR,KAAK,CAACS,SAAS,CAAzBD,KAAAA,CAER,uBAAwBvB,iBAAiB,EAAE,CAAnCyB,GAAG,oBAAHA,GAAG,CAAEC,MAAAA,oBAAAA,MAAAA,CAEb,GAAMC,QAAO,CAAGvB,gBAAgB,CAACK,OAAO,CAAG,CAAC,CAAG,CAAC,CAAC,CAEjD,oBAAgCV,KAAK,CAAC+B,QAAQ,CAACrB,OAAO,CAAC,oDAAhDmB,QAAQ,qBAAEC,WAAW,qBAE5B,GAAIpB,OAAO,EAAI,CAACmB,QAAQ,CAAE,CACxBC,WAAW,CAAC,IAAI,CAAC,CACnB,CAEA,GAAME,UAAS,CAAGhC,KAAK,CAACiC,WAAW,CAAC,UAAM,CACxCC,QAAQ,CAACC,MAAM,CAACP,OAAO,CAAE,CACvBQ,OAAO,CAAE,CAAC,CACVC,QAAQ,CAAEb,KAAK,CAAGjB,gBAAgB,CAClC+B,MAAM,CAAEC,MAAM,CAACC,GAAG,CAACD,MAAM,CAACE,KAAK,CAAC,CAChCC,eAAe,CAAE,IACnB,CAAC,CAAC,CAACC,KAAK,EAAE,CACZ,CAAC,CAAE,CAACf,OAAO,CAAEJ,KAAK,CAAC,CAAC,CAEpB,GAAMoB,UAAS,CAAG5C,KAAK,CAACiC,WAAW,CAAC,UAAM,CACxCC,QAAQ,CAACC,MAAM,CAACP,OAAO,CAAE,CACvBQ,OAAO,CAAE,CAAC,CACVC,QAAQ,CAAEb,KAAK,CAAGjB,gBAAgB,CAClC+B,MAAM,CAAEC,MAAM,CAACC,GAAG,CAACD,MAAM,CAACE,KAAK,CAAC,CAChCC,eAAe,CAAE,IACnB,CAAC,CAAC,CAACC,KAAK,CAAC,SAAA,KAAA,CAAkB,CAAjB,GAAEE,SAAAA,CAAU,KAAA,CAAVA,QAAAA,CACV,GAAI,CAACA,QAAQ,CAAE,CACb,OACF,CAEA,GAAInC,OAAO,CAAE,CACXa,iBAAiB,EAAE,CACrB,CAEA,GAAIJ,UAAU,CAACG,OAAO,CAAE,CACtBU,SAAS,EAAE,CACb,CAAC,IAAM,CACLF,WAAW,CAAC,KAAK,CAAC,CACpB,CACF,CAAC,CAAC,CACJ,CAAC,CAAE,CAACP,iBAAiB,CAAEK,OAAO,CAAEJ,KAAK,CAAEQ,SAAS,CAAEtB,OAAO,CAAC,CAAC,CAE3DV,KAAK,CAACqB,SAAS,CAAC,UAAM,CACpB,GAAI,CAACX,OAAO,CAAE,CACZ,MAAOoC,UAAS,CAClB,CAEA,GAAMC,oBAAmB,CAAG,QAAtBA,oBAAmB,EAAS,CAChC,GAAItC,WAAW,CAAE,CACfmC,SAAS,EAAE,CACb,CAEA,MAAO,KAAI,CACb,CAAC,CAED,GAAMI,aAAY,CAAG5C,gBAAgB,CACnC6C,WAAW,CACX,mBAAmB,CACnBF,mBAAmB,CACpB,CACD,MAAO,kBAAMC,aAAY,CAACE,MAAM,EAAE,GACpC,CAAC,CAAE,CAACzC,WAAW,CAAEmC,SAAS,CAAElC,OAAO,CAAC,CAAC,CAErC,GAAMyC,YAAW,CAAGnD,KAAK,CAACoB,MAAM,CAAiB,IAAI,CAAC,CAEtDpB,KAAK,CAACqB,SAAS,CAAC,UAAM,CACpB,GAAI8B,WAAW,CAAC7B,OAAO,GAAKZ,OAAO,CAAE,CACnC,GAAIA,OAAO,CAAE,CACXsB,SAAS,EAAE,CACb,CAAC,IAAM,CACLY,SAAS,EAAE,CACb,CACF,CACAO,WAAW,CAAC7B,OAAO,CAAGZ,OAAO,CAC/B,CAAC,CAAC,CAEF,GAAI,CAACmB,QAAQ,CAAE,MAAO,KAAI,CAE1B,MACE,MAAA,CAAA,aAAA,CAAC,QAAQ,CAAC,IAAI,CAAA,CACZ,aAAa,CAAEnB,OAAO,CAAG,MAAM,CAAG,MAAO,CACzC,wBAAwB,CAAA,IAAA,CACxB,uBAAuB,CAAC,QAAQ,CAChC,KAAK,CAAE0C,UAAU,CAACC,YAAa,CAC/B,qBAAqB,CAAET,SAAU,CACjC,MAAM,CAAE1B,MAAO,CAAA,CAEf,KAAA,CAAA,aAAA,CAAC,wBAAwB,CAAA,CACvB,kBAAkB,CAAEP,yBAA0B,CAC9C,iBAAiB,CAAC,QAAQ,CAC1B,QAAQ,CAAE,CAACF,WAAY,CACvB,OAAO,CAAEA,WAAW,CAAGmC,SAAS,CAAGE,SAAU,CAC7C,yBAAyB,CAAC,IAAI,CAAA,CAE9B,KAAA,CAAA,aAAA,CAAC,QAAQ,CAAC,IAAI,CAAA,CACZ,MAAM,CAAK5B,MAAO,YAAW,CAC7B,KAAK,CAAE,CACLoC,MAAM,CAACC,QAAQ,CACf,CACEC,eAAe,CAAA,CAAA,aAAA,CAAExC,KAAK,CAACyC,MAAM,IAAA,IAAA,EAAA,aAAA,GAAA,IAAA,EAAA,CAAA,IAAA,EAAA,CAAZzC,aAAAA,CAAcuC,QAAQ,CACvC3B,OAAAA,CAAAA,OACF,CAAC,CACD,CAAA,CACF,CACuB,CAC3B,KAAA,CAAA,aAAA,CAAC,IAAI,CAAA,CACH,KAAK,CAAE,CACL0B,MAAM,CAACI,OAAO,CACd,CAAEC,SAAS,CAAEjC,GAAG,CAAEkC,YAAY,CAAEjC,MAAO,CAAC,CACxCZ,KAAK,CACL,CACF,aAAa,CAAC,UAAU,CACxB,MAAM,CAAKG,MAAO,WAAU,CAAA,CAE5B,KAAA,CAAA,aAAA,CAAC,OAAO,CAAA,CACN,MAAM,CAAKA,MAAO,WAAU,CAC5B,KAAK,CAAEF,KAAM,CACb,KAAK,CAAE,CAAC,CAAEY,OAAAA,CAAAA,OAAQ,CAAC,CAAE0B,MAAM,CAACO,OAAO,CAAE/C,qBAAqB,CAAE,CAAA,CAE3DD,QAAQ,CACD,CACL,CACO,CAEpB,CAEA,cAAeL,MAAK,CAEpB,GAAM8C,OAAM,CAAGF,UAAU,CAACU,MAAM,CAAC,CAC/BP,QAAQ,CAAE,CACRQ,IAAI,CAAE,CACR,CAAC,CACDL,OAAO,gCACFN,UAAU,CAACY,kBAAkB,MAChCC,cAAc,CAAE,QAAA,EACjB,CAEDJ,OAAO,CAAE,CACPL,eAAe,CAAE,aAAa,CAC9BS,cAAc,CAAE,QAClB,CACF,CAAC,CAAC","sourceRoot":"../../src","sourcesContent":["import * as React from 'react';\nimport { Animated, BackHandler, Easing, StyleSheet, TouchableWithoutFeedback, View } from 'react-native';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport useEventCallback from 'use-event-callback';\nimport { useInternalTheme } from '../core/theming';\nimport { addEventListener } from '../utils/addEventListener';\nimport useAnimatedValue from '../utils/useAnimatedValue';\nimport Surface from './Surface';\nconst DEFAULT_DURATION = 220;\n\n/**\n * The Modal component is a simple way to present content above an enclosing view.\n * To render the `Modal` above other components, you'll need to wrap it with the [`Portal`](portal.html) component.\n *\n * <div class=\"screenshots\">\n *   <figure>\n *     <img class=\"medium\" src=\"screenshots/modal.gif\" />\n *   </figure>\n * </div>\n *\n * ## Usage\n * ```js\n * import * as React from 'react';\n * import { Modal, Portal, Text, Button, Provider } from 'react-native-paper';\n *\n * const MyComponent = () => {\n *   const [visible, setVisible] = React.useState(false);\n *\n *   const showModal = () => setVisible(true);\n *   const hideModal = () => setVisible(false);\n *   const containerStyle = {backgroundColor: 'white', padding: 20};\n *\n *   return (\n *     <Provider>\n *       <Portal>\n *         <Modal visible={visible} onDismiss={hideModal} contentContainerStyle={containerStyle}>\n *           <Text>Example Modal.  Click outside this area to dismiss.</Text>\n *         </Modal>\n *       </Portal>\n *       <Button style={{marginTop: 30}} onPress={showModal}>\n *         Show\n *       </Button>\n *     </Provider>\n *   );\n * };\n *\n * export default MyComponent;\n * ```\n */\nfunction Modal(_ref) {\n  var _theme$colors;\n  let {\n    dismissable = true,\n    visible = false,\n    overlayAccessibilityLabel = 'Close modal',\n    onDismiss = () => {},\n    children,\n    contentContainerStyle,\n    style,\n    theme: themeOverrides,\n    testID = 'modal'\n  } = _ref;\n  const theme = useInternalTheme(themeOverrides);\n  const visibleRef = React.useRef(visible);\n  React.useEffect(() => {\n    visibleRef.current = visible;\n  });\n  const onDismissCallback = useEventCallback(onDismiss);\n  const {\n    scale\n  } = theme.animation;\n  const {\n    top,\n    bottom\n  } = useSafeAreaInsets();\n  const opacity = useAnimatedValue(visible ? 1 : 0);\n  const [rendered, setRendered] = React.useState(visible);\n  if (visible && !rendered) {\n    setRendered(true);\n  }\n  const showModal = React.useCallback(() => {\n    Animated.timing(opacity, {\n      toValue: 1,\n      duration: scale * DEFAULT_DURATION,\n      easing: Easing.out(Easing.cubic),\n      useNativeDriver: true\n    }).start();\n  }, [opacity, scale]);\n  const hideModal = React.useCallback(() => {\n    Animated.timing(opacity, {\n      toValue: 0,\n      duration: scale * DEFAULT_DURATION,\n      easing: Easing.out(Easing.cubic),\n      useNativeDriver: true\n    }).start(_ref2 => {\n      let {\n        finished\n      } = _ref2;\n      if (!finished) {\n        return;\n      }\n      if (visible) {\n        onDismissCallback();\n      }\n      if (visibleRef.current) {\n        showModal();\n      } else {\n        setRendered(false);\n      }\n    });\n  }, [onDismissCallback, opacity, scale, showModal, visible]);\n  React.useEffect(() => {\n    if (!visible) {\n      return undefined;\n    }\n    const onHardwareBackPress = () => {\n      if (dismissable) {\n        hideModal();\n      }\n      return true;\n    };\n    const subscription = addEventListener(BackHandler, 'hardwareBackPress', onHardwareBackPress);\n    return () => subscription.remove();\n  }, [dismissable, hideModal, visible]);\n  const prevVisible = React.useRef(null);\n  React.useEffect(() => {\n    if (prevVisible.current !== visible) {\n      if (visible) {\n        showModal();\n      } else {\n        hideModal();\n      }\n    }\n    prevVisible.current = visible;\n  });\n  if (!rendered) return null;\n  return /*#__PURE__*/React.createElement(Animated.View, {\n    pointerEvents: visible ? 'auto' : 'none',\n    accessibilityViewIsModal: true,\n    accessibilityLiveRegion: \"polite\",\n    style: StyleSheet.absoluteFill,\n    onAccessibilityEscape: hideModal,\n    testID: testID\n  }, /*#__PURE__*/React.createElement(TouchableWithoutFeedback, {\n    accessibilityLabel: overlayAccessibilityLabel,\n    accessibilityRole: \"button\",\n    disabled: !dismissable,\n    onPress: dismissable ? hideModal : undefined,\n    importantForAccessibility: \"no\"\n  }, /*#__PURE__*/React.createElement(Animated.View, {\n    testID: `${testID}-backdrop`,\n    style: [styles.backdrop, {\n      backgroundColor: (_theme$colors = theme.colors) === null || _theme$colors === void 0 ? void 0 : _theme$colors.backdrop,\n      opacity\n    }]\n  })), /*#__PURE__*/React.createElement(View, {\n    style: [styles.wrapper, {\n      marginTop: top,\n      marginBottom: bottom\n    }, style],\n    pointerEvents: \"box-none\",\n    testID: `${testID}-wrapper`\n  }, /*#__PURE__*/React.createElement(Surface, {\n    testID: `${testID}-surface`,\n    theme: theme,\n    style: [{\n      opacity\n    }, styles.content, contentContainerStyle]\n  }, children)));\n}\nexport default Modal;\nconst styles = StyleSheet.create({\n  backdrop: {\n    flex: 1\n  },\n  wrapper: {\n    ...StyleSheet.absoluteFillObject,\n    justifyContent: 'center'\n  },\n  // eslint-disable-next-line react-native/no-color-literals\n  content: {\n    backgroundColor: 'transparent',\n    justifyContent: 'center'\n  }\n});\n//# sourceMappingURL=Modal.js.map"]},"metadata":{},"sourceType":"module"}