{"ast":null,"code":"var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value);});}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value));}catch(e){reject(e);}}function rejected(value){try{step(generator[\"throw\"](value));}catch(e){reject(e);}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected);}step((generator=generator.apply(thisArg,_arguments||[])).next());});};var __generator=this&&this.__generator||function(thisArg,body){var _={label:0,sent:function sent(){if(t[0]&1)throw t[1];return t[1];},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),\"throw\":verb(1),\"return\":verb(2)},typeof Symbol===\"function\"&&(g[Symbol.iterator]=function(){return this;}),g;function verb(n){return function(v){return step([n,v]);};}function step(op){if(f)throw new TypeError(\"Generator is already executing.\");while(_)try{if(f=1,y&&(t=op[0]&2?y[\"return\"]:op[0]?y[\"throw\"]||((t=y[\"return\"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue;}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break;}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break;}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break;}if(t[2])_.ops.pop();_.trys.pop();continue;}op=body.call(thisArg,_);}catch(e){op=[6,e];y=0;}finally{f=t=0;}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true};}};import NativeModules from\"react-native-web/dist/exports/NativeModules\";import findNodeHandle from\"react-native-web/dist/exports/findNodeHandle\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import{Placement,Rect,Size}from\"./Types\";import{DEFAULT_ARROW_SIZE,DEFAULT_BORDER_RADIUS}from\"./Constants\";export function getRectForRef(ref){return new Promise(function(resolve,reject){if(ref.current){NativeModules.UIManager.measure(findNodeHandle(ref.current),function(_1,_2,width,height,x,y){return resolve(new Rect(x,y,width,height));});}else{reject(new Error('getRectForRef - current is not set'));}});}export function waitForChange(getFirst,getSecond){return __awaiter(this,void 0,void 0,function(){var count,first,second;return __generator(this,function(_a){switch(_a.label){case 0:count=0;_a.label=1;case 1:return[4,getFirst()];case 2:first=_a.sent();return[4,getSecond()];case 3:second=_a.sent();return[4,new Promise(function(resolve){setTimeout(resolve,100);})];case 4:_a.sent();count++;if(count++>20){throw new Error('waitForChange - Timed out waiting for change (waited 2 seconds)');}_a.label=5;case 5:if(first.equals(second))return[3,1];_a.label=6;case 6:return[2];}});});}export function waitForNewRect(ref,initialRect){return __awaiter(this,void 0,void 0,function(){var rect;return __generator(this,function(_a){switch(_a.label){case 0:return[4,waitForChange(function(){return getRectForRef(ref);},function(){return Promise.resolve(initialRect);})];case 1:_a.sent();return[4,getRectForRef(ref)];case 2:rect=_a.sent();return[2,rect];}});});}export function sizeChanged(a,b){if(!a||!b)return false;return Math.round(a.width)!==Math.round(b.width)||Math.round(a.height)!==Math.round(b.height);}export function rectChanged(a,b){if(!a||!b)return false;return Math.round(a.x)!==Math.round(b.x)||Math.round(a.y)!==Math.round(b.y)||Math.round(a.width)!==Math.round(b.width)||Math.round(a.height)!==Math.round(b.height);}export function pointChanged(a,b){return Math.round(a.x)!==Math.round(b.x)||Math.round(a.y)!==Math.round(b.y);}export function getArrowSize(placement,arrowStyle){var _a=StyleSheet.flatten(arrowStyle),width=_a.width,height=_a.height;if(typeof width!=='number')width=DEFAULT_ARROW_SIZE.width;if(typeof height!=='number')height=DEFAULT_ARROW_SIZE.height;switch(placement){case Placement.LEFT:case Placement.RIGHT:return new Size(height,width);default:return new Size(width,height);}}export function getBorderRadius(popoverStyle){if(StyleSheet.flatten(popoverStyle).borderRadius===0)return 0;return StyleSheet.flatten(popoverStyle).borderRadius||DEFAULT_BORDER_RADIUS;}export function getChangedProps(props,prevProps,importantProps){return importantProps.filter(function(key){var curVal=props[key];var prevVal=prevProps[key];if(curVal instanceof Rect&&prevVal instanceof Rect){return!curVal.equals(prevVal);}return curVal!==prevVal;});}","map":{"version":3,"sources":["../src/Utility.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { NativeModules, findNodeHandle, StyleSheet } from 'react-native';\nimport { Placement, Rect, Size } from './Types';\nimport { DEFAULT_ARROW_SIZE, DEFAULT_BORDER_RADIUS } from './Constants';\nexport function getRectForRef(ref) {\n    return new Promise(function (resolve, reject) {\n        if (ref.current) {\n            NativeModules.UIManager.measure(findNodeHandle(ref.current), function (_1, _2, width, height, x, y) {\n                return resolve(new Rect(x, y, width, height));\n            });\n        }\n        else {\n            reject(new Error('getRectForRef - current is not set'));\n        }\n    });\n}\nexport function waitForChange(getFirst, getSecond) {\n    return __awaiter(this, void 0, void 0, function () {\n        var count, first, second;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    count = 0;\n                    _a.label = 1;\n                case 1: return [4 /*yield*/, getFirst()];\n                case 2:\n                    first = _a.sent();\n                    return [4 /*yield*/, getSecond()];\n                case 3:\n                    second = _a.sent();\n                    return [4 /*yield*/, new Promise(function (resolve) {\n                            setTimeout(resolve, 100);\n                        })];\n                case 4:\n                    _a.sent();\n                    count++;\n                    if (count++ > 20) {\n                        throw new Error('waitForChange - Timed out waiting for change (waited 2 seconds)');\n                    }\n                    _a.label = 5;\n                case 5:\n                    if (first.equals(second)) return [3 /*break*/, 1];\n                    _a.label = 6;\n                case 6: return [2 /*return*/];\n            }\n        });\n    });\n}\nexport function waitForNewRect(ref, initialRect) {\n    return __awaiter(this, void 0, void 0, function () {\n        var rect;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, waitForChange(function () { return getRectForRef(ref); }, function () { return Promise.resolve(initialRect); })];\n                case 1:\n                    _a.sent();\n                    return [4 /*yield*/, getRectForRef(ref)];\n                case 2:\n                    rect = _a.sent();\n                    return [2 /*return*/, rect];\n            }\n        });\n    });\n}\nexport function sizeChanged(a, b) {\n    if (!a || !b)\n        return false;\n    return Math.round(a.width) !== Math.round(b.width) ||\n        Math.round(a.height) !== Math.round(b.height);\n}\nexport function rectChanged(a, b) {\n    if (!a || !b)\n        return false;\n    return Math.round(a.x) !== Math.round(b.x) ||\n        Math.round(a.y) !== Math.round(b.y) ||\n        Math.round(a.width) !== Math.round(b.width) ||\n        Math.round(a.height) !== Math.round(b.height);\n}\nexport function pointChanged(a, b) {\n    return (Math.round(a.x) !== Math.round(b.x) || Math.round(a.y) !== Math.round(b.y));\n}\nexport function getArrowSize(placement, arrowStyle) {\n    var _a = StyleSheet.flatten(arrowStyle), width = _a.width, height = _a.height;\n    if (typeof width !== 'number')\n        (width = DEFAULT_ARROW_SIZE.width);\n    if (typeof height !== 'number')\n        (height = DEFAULT_ARROW_SIZE.height);\n    switch (placement) {\n        case Placement.LEFT:\n        case Placement.RIGHT:\n            return new Size(height, width);\n        default:\n            return new Size(width, height);\n    }\n}\nexport function getBorderRadius(popoverStyle) {\n    if (StyleSheet.flatten(popoverStyle).borderRadius === 0)\n        return 0;\n    return StyleSheet.flatten(popoverStyle).borderRadius || DEFAULT_BORDER_RADIUS;\n}\nexport function getChangedProps(props, prevProps, importantProps) {\n    return importantProps.filter(function (key) {\n        var curVal = props[key];\n        var prevVal = prevProps[key];\n        if (curVal instanceof Rect && prevVal instanceof Rect) {\n            return !curVal.equals(prevVal);\n        }\n        return curVal !== prevVal;\n    });\n}\n//# sourceMappingURL=Utility.js.map"]},"metadata":{},"sourceType":"module"}